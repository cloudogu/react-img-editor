(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"./generated-stories-entry.js":function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js").configure)([__webpack_require__("./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?!(?:^|\\/)\\.).)*?)\\/)(?!\\.)(?=.)[^/]*?\\.stories\\.tsx)$")],module,!1)}).call(this,__webpack_require__("./node_modules/webpack/buildin/module.js")(module))},"./node_modules/css-loader/dist/cjs.js!./node_modules/less-loader/dist/cjs.js!./src/styles/index.less":function(module,exports,__webpack_require__){(exports=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.i,'@font-face {\n  font-family: "iconfont";\n  src: url(\'//at.alicdn.com/t/font_1621501_k00ymzzhtbl.eot?t=1580659190858\');\n  /* IE9 */\n  src: url(\'//at.alicdn.com/t/font_1621501_k00ymzzhtbl.eot?t=1580659190858#iefix\') format(\'embedded-opentype\'), /* IE6-IE8 */ url(\'data:application/x-font-woff2;charset=utf-8;base64,d09GMgABAAAAAAbkAAsAAAAADjgAAAaWAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHEIGVgCEXgqNGIo6ATYCJAM8CyAABCAFhG0HgSAb8gujomZQTn5kf5XAgyH6RxkqmlbjaloCn5XEPXm2WNvJKz8ljA9LvOvwCR8Bb/DP/2Xe9/tM32qpBdfTQEIhWpFQjnfBWMTDU1ZsLpdtqd0zGX/l/+UrWlPV55O9mssem/3mqE6jDAgJwmH5eTztRUPwM7WDMoIdDnJz524nFIf0ACk8/+/tvu2fCcx4xFEQJZxQjJManXPM3ZP7G3Mj200Y9Ces7WwhvwaqAYT7X2v1vF9oAtO2XS/79/Qb7KDm0Zs3HiGJeDMJjQqhECm9YyCe9ZLNj0q8HAK5fZGZdXZzD8sclgk1zjLXsGyJ5ALsksKCx6GFHiipvZovAN6Un9cHvSyD4TvslZ6PUwsHm92ttc+TqKE/I2YXDzyOAgtuAQ56PRN/EFrhrTn5z9+TtoC5bXPMZoedw49RPY4ZW8apu7WTjNM2riN2vMw54/4/8ADD8oIoyeQKpUrNETQAL6n1t6jGwAoKDIadiIX4AQUeo1pBwDgGiRDjgCSI8UAyiAlAcoiJQAqISUBKCA2QCqIFSA0xFQocdmt9U4g30iH7gGOgH8DcwMqtsrYjYhmRI16OSagzxzy8Xk5LXcwookhjjZ6qq/TLyN5E9ZxpAWgEtfiDXuCi4g55ZEv6ySC95azGctWjCs2rRgAED/yRDR0nn2vesjxnDAABNuLe92L8XrOmZdcPKbqGkh8Gfcfxf8wPuIhM0tN+L+qGo8Dc8XohN05Xt33T9WhRJ4yHlOSthd8TqdiZK1qXwVBxJW3RshrDnFmrACyVhxl+7JobKV3NRMevu1NLbuT0REv32pG6fV78igOOlH5/B6AxXrBimkFVWcevpOkKzXQNw5F7HY6OXhVI47Us/sQND2rx9dJl++xJ7V5PtHy/A2U44DP86tPKa8+qbryouf5c3fta1dWrldevV9+4oWIsWwETK0xuuwxXdJ2jXbpcqaxmK2cvlc80V29r233eDoWispYbzjB0q0KhbMFIUgyRTw2YvXT1K34warHoow0aG15jyr+iSKZcFFqWdARFoqCqqDMY6leRPNV5js7Gpu0ofSf9GN+qmNOWgisVZcOStNK5Gzdqqne/7PQO5rO2l21drP36/X/AP5VKXtI+nTFM51iQvarI3XPtSwOASrViZUMDv1IJTuLf4f0vWRcXT0qChH5bdl9c/cXagl3l0tFlTZCPe1h424ftwsMiUIiBA3ltc62Du4PGHGimuVMtOnKsDgkzETNYoRisHOzljV0GC26DGZL5oPzgdpw69b36Y2MuZdKxo79f164ZGVLj/v1//wbXwEmaFPQDB+SgVvRksdckzU3W1cmVdSAoZIlSBcPBSk6WSAJJWQUiidTS3FxKpGhsqahtoU4RpQhapCMkErfhyhqWgkBXQ64xEmGROoWRSZW0vAYR7wM0vVaTQCDanCERIs9wiJDYxigTv5F4/ZpAcOOdIECbwp1aSBUEEMiu4LbFyitFThioGtjNs+0bkf/s/PjNqUuXBJApcu98T6RD+6WT8yGWEDCS4rTW1p3MydHcpxnBjlTEylXz+go+XT1XrYxgkQPFPjSWAiI6DdsIYqTQ5ke2kTuynzXoAABA3SKNVW611l5runmzxl6za5e+Wpx9nFq9fBhuNOLiUw/UGQeanuOBpz/OPt6IjxqFN2INg4fXmmwB9X8AANlgBr4PAIA4iu9X1krDDwHyIbuIFMb50EHCzXjQkQoAMAYTrcvKkodEGy/nPe0Jj6UyiRCSJEuE7RXgd+BO90TfzCd+m7HrAPhvnP8rmdN7QXZFiUFk7/HujdjH/frZqKa+PS9sikBjYwnHDpJzqTDR1Lnf4sJX23+xJCsDjGgPrOTU6Ky34BU2ECR3kLtxfnRhgc1RZcC1Dwak9QlG7Q+s1rfRWX/AW/uDoM0c5F6yd8rCecrVY0YtaNVgqkpDPuNjZFWteYv50Gk2+xXHI3Ioc1Q36dhLztEjZ7FHGOU9kUxlTI06Y66GzpFqmSo0khQibT9NM687JIYaWPWEIU0gSxmYSu4lg3jZ5GLV8f23UG7I0Tigwx/3R4gF5cqVrkQngvGc+0gdVqV+MJLrERKfUUJzRhrKGYlHjiskSuu9UQUZIlEkyG/1pWSgLCpPipfNeJ8F5Nh7bGJk5eQVFJWUKVehUpVqNWrNXegXTIGmlvIdBVzsExWn42VLY+9I28WGgi7NmiXBqjZ2pcfF8DTULFc0JRuHC/bz9+YFJ7KgmWk8Z4ayyNiidgAA\') format(\'woff2\'), url(\'//at.alicdn.com/t/font_1621501_k00ymzzhtbl.woff?t=1580659190858\') format(\'woff\'), url(\'//at.alicdn.com/t/font_1621501_k00ymzzhtbl.ttf?t=1580659190858\') format(\'truetype\'), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */ url(\'//at.alicdn.com/t/font_1621501_k00ymzzhtbl.svg?t=1580659190858#iconfont\') format(\'svg\');\n  /* iOS 4.1- */\n}\n.iconfont {\n  font-family: "iconfont" !important;\n  font-size: 16px;\n  font-style: normal;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n.icon-pen:before {\n  content: "\\e8ac";\n}\n.icon-check:before {\n  content: "\\e60c";\n}\n.icon-close:before {\n  content: "\\e6b8";\n}\n.icon-eraser:before {\n  content: "\\e78e";\n}\n.icon-download:before {\n  content: "\\e6f7";\n}\n.icon-mosaic:before {\n  content: "\\e77f";\n}\n.icon-dotted-line:before {\n  content: "\\e782";\n}\n.icon-square:before {\n  content: "\\e784";\n}\n.icon-circle:before {\n  content: "\\e785";\n}\n.icon-line2:before {\n  content: "\\e786";\n}\n.icon-text:before {\n  content: "\\e787";\n}\n.icon-arrow:before {\n  content: "\\e788";\n}\n.icon-cut:before {\n  content: "\\e789";\n}\n.icon-repeal:before {\n  content: "\\e78a";\n}\n.react-img-editor *:focus {\n  outline: none;\n}\n.react-img-editor-palette {\n  position: relative;\n  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC");\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.react-img-editor-container {\n  position: relative;\n}\n.react-img-editor-toolbar {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 42px;\n}\n.react-img-editor-toolbar-separator {\n  display: inline-block;\n  height: 16px;\n  width: 1px;\n  margin: 0 6px;\n  background-color: #D4D4D9;\n}\n.react-img-editor-toolbar-icon {\n  padding: 5px;\n}\n.react-img-editor-toolbar-icon i {\n  font-size: 16px;\n  cursor: pointer;\n  color: #A9A9AC;\n  padding: 3px;\n}\n.react-img-editor-toolbar-icon.activated i {\n  color: #7DB5FD;\n}\n.react-img-editor-toolbar-icon:hover i {\n  background-color: #F6F6F9;\n}\n.react-img-editor-toolbar-icon.disabled i {\n  color: #D4D4D9;\n  background-color: inherit;\n}\n.react-img-editor-tooltip {\n  opacity: 1;\n  padding: 0;\n}\n.react-img-editor-tooltip .rc-tooltip-arrow {\n  border-bottom-color: rgba(0, 0, 0, 0.1);\n}\n.react-img-editor-tooltip .rc-tooltip-inner {\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  height: 40px;\n  background-color: #FFF;\n  border-radius: 2px;\n  color: #A9A9AC;\n  padding-top: 0;\n  padding-bottom: 0;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n}\n.react-img-editor-param-setting {\n  display: flex;\n  align-items: center;\n}\n.react-img-editor-color-square {\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  border-radius: 2px;\n  margin: 0 2px;\n  box-sizing: border-box;\n  cursor: pointer;\n  border: 1px solid #EFEFF4;\n}\n.react-img-editor-color-square-activated {\n  border: 1px solid #007CFF;\n}\n.react-img-editor-line-type {\n  width: 20px;\n  height: 20px;\n  color: #BDBDC2;\n  margin: 0 8px;\n  cursor: pointer;\n  font-weight: 900;\n  line-height: 20px;\n}\n.react-img-editor-line-type-activated {\n  color: #007AFF;\n}\n.react-img-editor-stroke-circle {\n  display: inline-block;\n  border-radius: 50%;\n  background: #BDBDC2;\n  margin: 0 8px;\n  cursor: pointer;\n}\n.react-img-editor-stroke-circle-activated {\n  background: #007AFF;\n}\n.react-img-editor-stroke-circle-small {\n  width: 4px;\n  height: 4px;\n}\n.react-img-editor-stroke-circle-medium {\n  width: 10px;\n  height: 10px;\n}\n.react-img-editor-stroke-circle-large {\n  width: 18px;\n  height: 18px;\n}\n.react-img-editor-font-size {\n  display: inline-block;\n  line-height: 18px;\n  margin-left: -1px;\n  outline: none;\n  border: 1px solid #D7D6DB;\n  font-size: 12px;\n  color: #97979B;\n  cursor: pointer;\n}\n.react-img-editor-font-size:first-child:not(:last-child) {\n  border-top-left-radius: 4px;\n  border-bottom-left-radius: 4px;\n}\n.react-img-editor-font-size:last-child:not(:first-child) {\n  border-top-right-radius: 4px;\n  border-bottom-right-radius: 4px;\n}\n.react-img-editor-font-size-activated {\n  background-color: #007AFF;\n  color: #fff;\n  border: 1px solid #007AFF;\n}\n',""]),module.exports=exports},"./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?!(?:^|\\/)\\.).)*?)\\/)(?!\\.)(?=.)[^/]*?\\.stories\\.tsx)$":function(module,exports,__webpack_require__){var map={"./index.stories.tsx":"./src/index.stories.tsx"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?!(?:^|\\/)\\.).)*?)\\/)(?!\\.)(?=.)[^/]*?\\.stories\\.tsx)$"},"./src/index.stories.tsx":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Simple",(function(){return index_stories_Simple})),__webpack_require__.d(__webpack_exports__,"GermanTexts",(function(){return index_stories_GermanTexts})),__webpack_require__.d(__webpack_exports__,"MulitpleInstances",(function(){return index_stories_MulitpleInstances}));var react=__webpack_require__("./node_modules/react/index.js"),react_default=__webpack_require__.n(react),lib=(__webpack_require__("./node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/web.timers.js"),__webpack_require__("./node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js"),__webpack_require__("./node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.reflect.construct.js"),__webpack_require__("./node_modules/core-js/modules/es.object.create.js"),__webpack_require__("./node_modules/konva/lib/index.js")),lib_default=__webpack_require__.n(lib);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}var Plugin=_createClass((function Plugin(){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Plugin),this.name=void 0,this.iconfont=void 0,this.title=void 0,this.language=void 0,this.params=void 0,this.defaultParamValue=void 0,this.shapeName=void 0,this.onEnter=void 0,this.onDrawStart=void 0,this.onClick=void 0,this.onDraw=void 0,this.onDrawEnd=void 0,this.onLeave=void 0,this.onNodeRecreate=void 0})),prefixCls="react-img-editor",transformerStyle={centeredScaling:!1,rotateEnabled:!1,anchorCornerRadius:3,anchorStrokeWidth:1,borderStrokeWidth:1,anchorStroke:"#007AFF",borderStroke:"#007AFF",anchorFill:"#FFF",anchorSize:6,rotateAnchorOffset:20};__webpack_require__("./node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.date.to-string.js");function uuid(){return"_"+Math.random().toString(36).substr(2,9)}function Arrow_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Arrow_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var Arrow_Arrow=function(_Plugin){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(Arrow,_Plugin);var _super=_createSuper(Arrow);function Arrow(){var _this;Arrow_classCallCheck(this,Arrow);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="arrow",_this.iconfont="iconfont icon-arrow",_this.title={en:"Insert Arrow",de:"Pfeil einfügen"},_this.params=["strokeWidth","color"],_this.defaultParamValue={strokeWidth:6,lineType:"solid",color:"#F5222D"},_this.shapeName="arrow",_this.lastArrow=null,_this.transformer=null,_this.selectedNode=null,_this.isPaint=!1,_this.started=!1,_this.startPoints=[0,0],_this.enableTransform=function(drawEventParams,node){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer;_this.transformer||(_this.transformer=new lib_default.a.Transformer(Object.assign({},transformerStyle,{rotateEnabled:!0})),drawLayer.add(_this.transformer),_this.transformer.attachTo(node),node.on("mouseenter",(function(){stage.container().style.cursor="move"})),node.on("mouseleave",(function(){stage.container().style.cursor="default"})),stage.container().style.cursor="move"),node&&node.draggable(!0),drawLayer.draw()},_this.disableTransform=function(drawEventParams,node,remove){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,pubSub=drawEventParams.pubSub;_this.transformer&&(_this.transformer.remove(),_this.transformer=null),node&&(node.draggable(!1),node.off("mouseenter"),node.off("mouseleave"),stage.container().style.cursor="default",remove&&(node.hide(),pubSub.pub("PUSH_HISTORY",node),node.remove())),_this.selectedNode=null,drawLayer.draw()},_this.onEnter=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,container=stage.container();container.tabIndex=1,container.focus(),container.addEventListener("keyup",(function(e){"Backspace"===e.key&&_this.selectedNode&&(_this.disableTransform(drawEventParams,_this.selectedNode,!0),drawLayer.draw())}))},_this.onClick=function(drawEventParams){var event=drawEventParams.event;event.target.name&&"arrow"===event.target.name()?_this.selectedNode&&_this.selectedNode._id===event.target._id||(_this.selectedNode&&_this.disableTransform(drawEventParams,_this.selectedNode),_this.enableTransform(drawEventParams,event.target),_this.selectedNode=event.target):_this.disableTransform(drawEventParams,_this.selectedNode)},_this.onDrawStart=function(){_this.isPaint=!0},_this.onDraw=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,paramValue=drawEventParams.paramValue,pubSub=drawEventParams.pubSub,pos=stage.getPointerPosition();if(_this.isPaint&&!_this.transformer&&pos){if(!_this.started&&pos){_this.startPoints=[pos.x,pos.y];var strokeColor=paramValue&&paramValue.color?paramValue.color:_this.defaultParamValue.color;_this.lastArrow=new lib_default.a.Arrow({id:uuid(),name:"arrow",stroke:strokeColor,strokeWidth:paramValue&&paramValue.strokeWidth?paramValue.strokeWidth:_this.defaultParamValue.strokeWidth,globalCompositeOperation:"source-over",points:_this.startPoints,dashEnabled:!(!paramValue||!paramValue.lineType||"dash"!==paramValue.lineType),dash:[8],fill:strokeColor,strokeScaleEnabled:!1}),_this.lastArrow.on("transformend",(function(){pubSub.pub("PUSH_HISTORY",this)})),_this.lastArrow.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)})),drawLayer.add(_this.lastArrow),_this.started=!0}_this.lastArrow.points([_this.startPoints[0],_this.startPoints[1],pos.x,pos.y]),drawLayer.batchDraw()}},_this.onDrawEnd=function(drawEventParams){var pubSub=drawEventParams.pubSub;_this.started&&(_this.disableTransform(drawEventParams,_this.selectedNode),_this.lastArrow&&pubSub.pub("PUSH_HISTORY",_this.lastArrow)),_this.isPaint=!1,_this.started=!1},_this.onLeave=function(drawEventParams){_this.isPaint=!1,_this.started=!1,_this.disableTransform(drawEventParams,_this.selectedNode)},_this.onNodeRecreate=function(drawEventParams,node){var pubSub=drawEventParams.pubSub;node.on("transformend",(function(){pubSub.pub("PUSH_HISTORY",this)})),node.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)}))},_this}return function Arrow_createClass(Constructor,protoProps,staticProps){return protoProps&&Arrow_defineProperties(Constructor.prototype,protoProps),staticProps&&Arrow_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Arrow)}(Plugin);function Circle_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Circle_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Circle_setPrototypeOf(o,p){return Circle_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Circle_setPrototypeOf(o,p)}function Circle_createSuper(Derived){var hasNativeReflectConstruct=function Circle_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Circle_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Circle_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Circle_possibleConstructorReturn(this,result)}}function Circle_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Circle_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Circle_getPrototypeOf(o){return Circle_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Circle_getPrototypeOf(o)}var Circle_Circle=function(_Plugin){!function Circle_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Circle_setPrototypeOf(subClass,superClass)}(Circle,_Plugin);var _super=Circle_createSuper(Circle);function Circle(){var _this;Circle_classCallCheck(this,Circle);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="circle",_this.iconfont="iconfont icon-circle",_this.title={en:"Insert circle",de:"Kreis einfügen"},_this.params=["strokeWidth","lineType","color"],_this.defaultParamValue={strokeWidth:6,lineType:"solid",color:"#F5222D"},_this.shapeName="circle",_this.lastCircle=null,_this.transformer=null,_this.selectedNode=null,_this.isPaint=!1,_this.started=!1,_this.startPoint=[0,0],_this.enableTransform=function(drawEventParams,node){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer;_this.transformer||(_this.transformer=new lib_default.a.Transformer(Object.assign({},transformerStyle)),drawLayer.add(_this.transformer),_this.transformer.attachTo(node),node.on("mouseenter",(function(){stage.container().style.cursor="move"})),node.on("mouseleave",(function(){stage.container().style.cursor="default"})),stage.container().style.cursor="move"),node&&node.draggable(!0),drawLayer.draw()},_this.disableTransform=function(drawEventParams,node,remove){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,pubSub=drawEventParams.pubSub;_this.transformer&&(_this.transformer.remove(),_this.transformer=null),node&&(node.draggable(!1),node.off("mouseenter"),node.off("mouseleave"),stage.container().style.cursor="default",remove&&(node.hide(),pubSub.pub("PUSH_HISTORY",node),node.remove())),_this.selectedNode=null,drawLayer.draw()},_this.onEnter=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,container=stage.container();container.tabIndex=1,container.focus(),container.addEventListener("keyup",(function(e){"Backspace"===e.key&&_this.selectedNode&&(_this.disableTransform(drawEventParams,_this.selectedNode,!0),drawLayer.draw())}))},_this.onClick=function(drawEventParams){var event=drawEventParams.event;event.target.name&&"circle"===event.target.name()?_this.selectedNode&&_this.selectedNode._id===event.target._id||(_this.selectedNode&&_this.disableTransform(drawEventParams,_this.selectedNode),_this.enableTransform(drawEventParams,event.target),_this.selectedNode=event.target):_this.disableTransform(drawEventParams,_this.selectedNode)},_this.onDrawStart=function(){_this.isPaint=!0},_this.onDraw=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,paramValue=drawEventParams.paramValue,pubSub=drawEventParams.pubSub,pos=stage.getPointerPosition();if(_this.isPaint&&!_this.transformer&&pos){_this.started||(_this.startPoint=[pos.x,pos.y],_this.lastCircle=new lib_default.a.Circle({id:uuid(),name:"circle",stroke:paramValue&&paramValue.color?paramValue.color:_this.defaultParamValue.color,strokeWidth:paramValue&&paramValue.strokeWidth?paramValue.strokeWidth:_this.defaultParamValue.strokeWidth,globalCompositeOperation:"source-over",radius:0,dashEnabled:!(!paramValue||!paramValue.lineType||"dash"!==paramValue.lineType),dash:[8],strokeScaleEnabled:!1}),_this.lastCircle.on("transformend",(function(){pubSub.pub("PUSH_HISTORY",this)})),_this.lastCircle.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)})),drawLayer.add(_this.lastCircle),_this.started=!0);var radius=Math.sqrt(Math.pow(pos.x-_this.startPoint[0],2)+Math.pow(pos.y-_this.startPoint[1],2))/2;_this.lastCircle.x((pos.x+_this.startPoint[0])/2),_this.lastCircle.y((pos.y+_this.startPoint[1])/2),_this.lastCircle.setAttr("radius",radius),drawLayer.batchDraw()}},_this.onDrawEnd=function(drawEventParams){var pubSub=drawEventParams.pubSub;_this.started&&(_this.disableTransform(drawEventParams,_this.selectedNode),_this.lastCircle&&pubSub.pub("PUSH_HISTORY",_this.lastCircle)),_this.isPaint=!1,_this.started=!1},_this.onLeave=function(drawEventParams){_this.isPaint=!1,_this.started=!1,_this.disableTransform(drawEventParams,_this.selectedNode)},_this.onNodeRecreate=function(drawEventParams,node){var pubSub=drawEventParams.pubSub;node.on("transformend",(function(){pubSub.pub("PUSH_HISTORY",this)})),node.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)}))},_this}return function Circle_createClass(Constructor,protoProps,staticProps){return protoProps&&Circle_defineProperties(Constructor.prototype,protoProps),staticProps&&Circle_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Circle)}(Plugin);function Crop_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Crop_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Crop_setPrototypeOf(o,p){return Crop_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Crop_setPrototypeOf(o,p)}function Crop_createSuper(Derived){var hasNativeReflectConstruct=function Crop_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Crop_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Crop_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Crop_possibleConstructorReturn(this,result)}}function Crop_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Crop_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Crop_getPrototypeOf(o){return Crop_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Crop_getPrototypeOf(o)}var Crop_Crop=function(_Plugin){!function Crop_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Crop_setPrototypeOf(subClass,superClass)}(Crop,_Plugin);var _super=Crop_createSuper(Crop);function Crop(){var _this;Crop_classCallCheck(this,Crop);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="crop",_this.iconfont="iconfont icon-cut",_this.title={en:"Image cropping",de:"Bild zuschneiden"},_this.params=[],_this.isPaint=!1,_this.virtualLayer=null,_this.rect=null,_this.transformer=null,_this.toolbarId="react-img-editor-crop-toolbar"+uuid(),_this.usage={en:"Drag the border to adjust the scope of the image display",de:"Ziehen Sie den Rand um den Umfang des Ausschnitts anzupassen"},_this.getRectWidth=function(){return _this.rect?_this.rect.getClientRect({skipTransform:!1}).width:0},_this.getRectHeight=function(){return _this.rect?_this.rect.getClientRect({skipTransform:!1}).height:0},_this.getRectX=function(){return _this.rect?_this.rect.getClientRect({skipTransform:!1}).x:0},_this.getRectY=function(){return _this.rect?_this.rect.getClientRect({skipTransform:!1}).y:0},_this.adjustToolbarPosition=function(stage){var left,top,$toolbar=document.getElementById(_this.toolbarId);$toolbar&&(left=_this.getRectWidth()>=0?_this.getRectX():_this.getRectX()-300,top=_this.getRectHeight()>=0?_this.getRectHeight()+_this.getRectY()+20:_this.getRectY()+20,left<0&&(left=0),left>stage.width()-300&&(left=stage.width()-300),top<0&&(top=0),top>stage.height()&&(top=stage.height()),$toolbar.style.left=left+"px",$toolbar.style.top=top+"px")},_this.createCropToolbar=function(stage,sureBtnEvent,cancelBtnEvent){if(!document.getElementById(_this.toolbarId)){var fragment=new DocumentFragment,$cropToolbar=document.createElement("div");$cropToolbar.setAttribute("id",_this.toolbarId);$cropToolbar.setAttribute("style","position: absolute; z-index: 1000; box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.15);background: #FFF; width: 300px; height: 40px; display: flex; align-items: center; padding: 0 12px;font-size: 12px;"),fragment.appendChild($cropToolbar);var $textNode=document.createTextNode(_this.usage[_this.language]||_this.usage.en);$cropToolbar.appendChild($textNode);var btnStyle="display: inline-block; width: 32px; height: 24px; border: 1px solid #C9C9D0;border-radius: 2px; text-align: center; cursor: pointer; line-height: 24px;",$cancelBtn=document.createElement("span");$cancelBtn.setAttribute("style",btnStyle+"background: #FFF; margin: 0 8px 0 10px;"),$cancelBtn.onclick=cancelBtnEvent,$cropToolbar.appendChild($cancelBtn);var $closeIcon=document.createElement("i");$closeIcon.setAttribute("class","iconfont icon-close"),$closeIcon.setAttribute("style","font-size: 12px;"),$cancelBtn.appendChild($closeIcon);var $sureBtn=document.createElement("span");$sureBtn.setAttribute("style",btnStyle+"background: #007AFF; color: #FFF;"),$sureBtn.onclick=sureBtnEvent,$cropToolbar.appendChild($sureBtn);var $checkIcon=document.createElement("i");$checkIcon.setAttribute("class","iconfont icon-check"),$checkIcon.setAttribute("style","font-size: 12px;"),$sureBtn.appendChild($checkIcon),stage.container().appendChild(fragment)}},_this.reset=function(stage){var $toolbar=document.getElementById(_this.toolbarId);$toolbar&&stage.container().removeChild($toolbar),_this.virtualLayer&&_this.virtualLayer.remove(),_this.rect&&(_this.rect.off("mouseenter"),_this.rect.off("mouseleave"))},_this.onEnter=function(drawEventParams){drawEventParams.stage.container().style.cursor="crosshair"},_this.onDrawStart=function(drawEventParams){var stage=drawEventParams.stage,startPos=stage.getPointerPosition();if(!_this.isPaint&&startPos&&!document.getElementById(_this.toolbarId)){_this.isPaint=!0,_this.virtualLayer=new lib_default.a.Layer,stage.add(_this.virtualLayer),_this.virtualLayer.setZIndex(2);var maskRect=new lib_default.a.Rect({globalCompositeOperation:"source-over",x:0,y:0,width:stage.width(),height:stage.height(),fill:"rgba(0, 0, 0, .6)"});_this.virtualLayer.add(maskRect),_this.rect=new lib_default.a.Rect({x:startPos.x,y:startPos.y,fill:"#FFF",draggable:!0,globalCompositeOperation:"destination-out"}),_this.rect.on("mouseenter",(function(){stage.container().style.cursor="move"})),_this.rect.on("mouseleave",(function(){stage.container().style.cursor="default"})),_this.virtualLayer.add(_this.rect),_this.virtualLayer.draw()}},_this.onDraw=function(drawEventParams){var stage=drawEventParams.stage,endPos=stage.getPointerPosition();_this.isPaint&&endPos&&(document.getElementById(_this.toolbarId)||(_this.rect.width(endPos.x-_this.getRectX()),_this.rect.height(endPos.y-_this.getRectY()),_this.rect.dragBoundFunc((function(pos){var x=pos.x,y=pos.y;return _this.transformer.width()>=0?(pos.x<=0&&(x=0),pos.x>=stage.width()-_this.transformer.width()&&(x=stage.width()-_this.transformer.width())):(pos.x>=stage.width()&&(x=stage.width()),pos.x<=-_this.transformer.width()&&(x=-_this.transformer.width())),_this.transformer.height()>=0?(pos.y<=0&&(y=0),pos.y>=stage.height()-_this.transformer.height()&&(y=stage.height()-_this.transformer.height())):(pos.y>=stage.height()&&(y=stage.height()),pos.y<=-_this.transformer.height()&&(y=-_this.transformer.height())),_this.adjustToolbarPosition(stage),{x:x,y:y}})),_this.virtualLayer.draw()))},_this.onDrawEnd=function(drawEventParams){var stage=drawEventParams.stage,pixelRatio=drawEventParams.pixelRatio,reload=drawEventParams.reload;_this.isPaint?(_this.isPaint=!1,_this.transformer=new lib_default.a.Transformer(Object.assign({node:_this.rect},transformerStyle,{boundBoxFunc:function boundBoxFunc(oldBox,newBox){var x=newBox.x,y=newBox.y,width=newBox.width,height=newBox.height;return newBox.width>=0?(newBox.x<=0&&(x=0,width=newBox.width+newBox.x),newBox.x>=stage.width()-newBox.width&&(width=stage.width()-oldBox.x)):(newBox.x>=stage.width()&&(x=stage.width(),width=newBox.width+(newBox.x-stage.width())),newBox.x<=-newBox.width&&(width=-oldBox.x)),newBox.height>=0?(newBox.y<=0&&(y=0,height=newBox.height+newBox.y),newBox.y>=stage.height()-newBox.height&&(height=stage.height()-oldBox.y)):(newBox.y>=stage.height()&&(y=stage.height(),height=newBox.height+(newBox.y-stage.height())),newBox.y<=-newBox.height&&(height=-oldBox.y)),_this.adjustToolbarPosition(stage),{x:x,y:y,width:width,height:height}}})),_this.virtualLayer.add(_this.transformer),_this.virtualLayer.draw(),_this.createCropToolbar(stage,(function(){if(!(_this.getRectWidth()<2||_this.getRectHeight()<2)){_this.virtualLayer.remove(_this.transformer);var dataURL=stage.toDataURL({x:_this.getRectX(),y:_this.getRectY(),width:_this.getRectWidth(),height:_this.getRectHeight(),pixelRatio:pixelRatio,mimeType:"image/jpeg"}),imageObj=new Image;imageObj.onload=function(){reload(imageObj,_this.getRectWidth(),_this.getRectHeight()),_this.reset(stage)},imageObj.src=dataURL,stage.container().style.cursor="crosshair"}}),(function(){_this.reset(stage),stage.container().style.cursor="crosshair"})),_this.adjustToolbarPosition(stage)):_this.isPaint=!1},_this.onLeave=function(drawEventParams){var stage=drawEventParams.stage;_this.reset(stage),stage.container().style.cursor="default",_this.isPaint=!1},_this}return function Crop_createClass(Constructor,protoProps,staticProps){return protoProps&&Crop_defineProperties(Constructor.prototype,protoProps),staticProps&&Crop_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Crop)}(Plugin);__webpack_require__("./node_modules/core-js/modules/web.url.js");function Download_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Download_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Download_setPrototypeOf(o,p){return Download_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Download_setPrototypeOf(o,p)}function Download_createSuper(Derived){var hasNativeReflectConstruct=function Download_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Download_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Download_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Download_possibleConstructorReturn(this,result)}}function Download_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Download_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Download_getPrototypeOf(o){return Download_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Download_getPrototypeOf(o)}var Download=function(_Plugin){!function Download_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Download_setPrototypeOf(subClass,superClass)}(Download,_Plugin);var _super=Download_createSuper(Download);function Download(){var _this;Download_classCallCheck(this,Download);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="download",_this.iconfont="iconfont icon-download",_this.title={en:"Download image",de:"Bild herunterladen"},_this.onEnter=function(drawEventParams){var stage=drawEventParams.stage,pixelRatio=drawEventParams.pixelRatio;setTimeout((function(){stage.toCanvas({pixelRatio:pixelRatio}).toBlob((function(blob){var link=document.createElement("a");link.download="",link.href=URL.createObjectURL(blob),link.click()}),"image/jpeg")}),100)},_this}return function Download_createClass(Constructor,protoProps,staticProps){return protoProps&&Download_defineProperties(Constructor.prototype,protoProps),staticProps&&Download_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Download)}(Plugin);function Eraser_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Eraser_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Eraser_setPrototypeOf(o,p){return Eraser_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Eraser_setPrototypeOf(o,p)}function Eraser_createSuper(Derived){var hasNativeReflectConstruct=function Eraser_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Eraser_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Eraser_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Eraser_possibleConstructorReturn(this,result)}}function Eraser_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Eraser_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Eraser_getPrototypeOf(o){return Eraser_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Eraser_getPrototypeOf(o)}var Eraser_Eraser=function(_Plugin){!function Eraser_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Eraser_setPrototypeOf(subClass,superClass)}(Eraser,_Plugin);var _super=Eraser_createSuper(Eraser);function Eraser(){var _this;Eraser_classCallCheck(this,Eraser);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="eraser",_this.iconfont="iconfont icon-eraser",_this.title={en:"Erase",de:"Radieren"},_this.params=["strokeWidth"],_this.defaultParamValue={strokeWidth:6},_this.lastLine=null,_this.isPaint=!1,_this.onDrawStart=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,paramValue=drawEventParams.paramValue,pos=stage.getPointerPosition();pos&&(_this.isPaint=!0,_this.lastLine=new lib_default.a.Line({id:uuid(),stroke:"#df4b26",strokeWidth:paramValue&&paramValue.strokeWidth?paramValue.strokeWidth:_this.defaultParamValue.strokeWidth,globalCompositeOperation:"destination-out",points:[pos.x,pos.y]}),drawLayer.add(_this.lastLine))},_this.onDraw=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,pos=stage.getPointerPosition();if(_this.isPaint&&pos){var newPoints=_this.lastLine.points().concat([pos.x,pos.y]);_this.lastLine.points(newPoints),drawLayer.batchDraw()}},_this.onDrawEnd=function(drawEventParams){var pubSub=drawEventParams.pubSub;_this.isPaint=!1,pubSub.pub("PUSH_HISTORY",_this.lastLine)},_this.onLeave=function(){_this.isPaint=!1},_this}return function Eraser_createClass(Constructor,protoProps,staticProps){return protoProps&&Eraser_defineProperties(Constructor.prototype,protoProps),staticProps&&Eraser_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Eraser)}(Plugin);__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Mosaic_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Mosaic_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Mosaic_setPrototypeOf(o,p){return Mosaic_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Mosaic_setPrototypeOf(o,p)}function Mosaic_createSuper(Derived){var hasNativeReflectConstruct=function Mosaic_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Mosaic_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Mosaic_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Mosaic_possibleConstructorReturn(this,result)}}function Mosaic_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Mosaic_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Mosaic_getPrototypeOf(o){return Mosaic_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Mosaic_getPrototypeOf(o)}var Mosaic_Mosaic=function(_Plugin){!function Mosaic_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Mosaic_setPrototypeOf(subClass,superClass)}(Mosaic,_Plugin);var _super=Mosaic_createSuper(Mosaic);function Mosaic(){var _this;Mosaic_classCallCheck(this,Mosaic);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="mosaic",_this.iconfont="iconfont icon-mosaic",_this.title={en:"Mosaic",de:"Mosaik"},_this.params=["strokeWidth"],_this.defaultParamValue={strokeWidth:6},_this.isPaint=!1,_this.tiles=[],_this.tileRowSize=0,_this.tileColumnSize=0,_this.width=0,_this.height=0,_this.rectGroup=null,_this.drawTile=function(tiles,drawLayer){(tiles=[].concat(tiles)).forEach((function(tile){if(!tile.isFilled){if(!tile.color){for(var dataLen=tile.data.length,r=0,g=0,b=0,a=0,i=0;i<dataLen;i+=4)r+=tile.data[i],g+=tile.data[i+1],b+=tile.data[i+2],a+=tile.data[i+3];var pixelLen=dataLen/4;tile.color={r:Math.round(r/pixelLen),g:Math.round(g/pixelLen),b:Math.round(b/pixelLen),a:Math.round(a/pixelLen)}}var color=tile.color,x=5*tile.column,y=5*tile.row,w=tile.pixelWidth,h=tile.pixelHeight,rect=new lib_default.a.Rect({globalCompositeOperation:"source-over",x:x,y:y,width:w,height:h,fill:"rgba("+color.r+", "+color.g+", "+color.b+", "+color.a/255+")"});_this.rectGroup.add(rect),tile.isFilled=!0}})),drawLayer.add(_this.rectGroup),drawLayer.draw()},_this.getTilesByPoint=function(x,y,strokeWidth){for(var ts=[],startRow=Math.max(0,Math.floor(y/5)-Math.floor(strokeWidth/2)),startColumn=Math.max(0,Math.floor(x/5)-Math.floor(strokeWidth/2)),endRow=Math.min(_this.tileRowSize,startRow+strokeWidth),endColumn=Math.min(_this.tileColumnSize,startColumn+strokeWidth);startRow<endRow;){for(var column=startColumn;column<endColumn;)ts.push(_this.tiles[startRow*_this.tileColumnSize+column]),column+=1;startRow+=1}return ts},_this.onDrawStart=function(drawEventParams){var stage=drawEventParams.stage,imageData=drawEventParams.imageData;_this.tiles=[],_this.width=stage.width(),_this.height=stage.height(),_this.tileRowSize=Math.ceil(_this.height/5),_this.tileColumnSize=Math.ceil(_this.width/5),_this.rectGroup=new lib_default.a.Group({id:uuid()});for(var i=0;i<_this.tileRowSize;i++)for(var j=0;j<_this.tileColumnSize;j++){for(var tile={row:i,column:j,pixelWidth:5,pixelHeight:5,data:[]},data=[],pixelPosition=4*(5*_this.width*tile.row+5*tile.column),pixelRowAmount=tile.pixelHeight,_i=0;_i<pixelRowAmount;_i++){var position=pixelPosition+4*_this.width*_i;data=[].concat(_toConsumableArray(data),_toConsumableArray(imageData.data.slice(position,position+4*tile.pixelWidth)))}tile.data=data,_this.tiles.push(tile)}_this.isPaint=!0},_this.onDraw=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,paramValue=drawEventParams.paramValue,pos=stage.getPointerPosition();if(_this.isPaint&&pos){var strokeWidth=paramValue&&paramValue.strokeWidth?paramValue.strokeWidth:_this.defaultParamValue.strokeWidth;_this.drawTile(_this.getTilesByPoint(pos.x,pos.y,strokeWidth),drawLayer)}},_this.onDrawEnd=function(drawEventParams){var pubSub=drawEventParams.pubSub;_this.isPaint=!1,pubSub.pub("PUSH_HISTORY",_this.rectGroup)},_this.onLeave=function(){_this.isPaint=!1},_this}return function Mosaic_createClass(Constructor,protoProps,staticProps){return protoProps&&Mosaic_defineProperties(Constructor.prototype,protoProps),staticProps&&Mosaic_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Mosaic)}(Plugin);function Pen_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Pen_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Pen_setPrototypeOf(o,p){return Pen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Pen_setPrototypeOf(o,p)}function Pen_createSuper(Derived){var hasNativeReflectConstruct=function Pen_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Pen_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Pen_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Pen_possibleConstructorReturn(this,result)}}function Pen_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Pen_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Pen_getPrototypeOf(o){return Pen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Pen_getPrototypeOf(o)}var Pen_Pen=function(_Plugin){!function Pen_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Pen_setPrototypeOf(subClass,superClass)}(Pen,_Plugin);var _super=Pen_createSuper(Pen);function Pen(){var _this;Pen_classCallCheck(this,Pen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="pen",_this.iconfont="iconfont icon-pen",_this.title={en:"Brushes",de:"Frei zeichnen"},_this.params=["strokeWidth","lineType","color"],_this.defaultParamValue={strokeWidth:6,lineType:"solid",color:"#F5222D"},_this.lastLine=null,_this.isPaint=!1,_this.onDrawStart=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,paramValue=drawEventParams.paramValue,pos=stage.getPointerPosition();pos&&(_this.isPaint=!0,_this.lastLine=new lib_default.a.Line({id:uuid(),stroke:paramValue&&paramValue.color?paramValue.color:_this.defaultParamValue.color,strokeWidth:paramValue&&paramValue.strokeWidth?paramValue.strokeWidth:_this.defaultParamValue.strokeWidth,globalCompositeOperation:"source-over",points:[pos.x,pos.y],dashEnabled:!(!paramValue||!paramValue.lineType||"dash"!==paramValue.lineType),dash:[8],tension:1,lineCap:"round",lineJoin:"round"}),drawLayer.add(_this.lastLine))},_this.onDraw=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,pos=stage.getPointerPosition();if(_this.isPaint&&pos){var newPoints=_this.lastLine.points().concat([pos.x,pos.y]);_this.lastLine.points(newPoints),drawLayer.batchDraw()}},_this.onDrawEnd=function(drawEventParams){var pubSub=drawEventParams.pubSub;_this.isPaint=!1,pubSub.pub("PUSH_HISTORY",_this.lastLine)},_this.onLeave=function(){_this.isPaint=!1},_this}return function Pen_createClass(Constructor,protoProps,staticProps){return protoProps&&Pen_defineProperties(Constructor.prototype,protoProps),staticProps&&Pen_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Pen)}(Plugin);function Rect_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Rect_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Rect_setPrototypeOf(o,p){return Rect_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Rect_setPrototypeOf(o,p)}function Rect_createSuper(Derived){var hasNativeReflectConstruct=function Rect_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Rect_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Rect_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Rect_possibleConstructorReturn(this,result)}}function Rect_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Rect_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Rect_getPrototypeOf(o){return Rect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Rect_getPrototypeOf(o)}var Rect_Rect=function(_Plugin){!function Rect_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Rect_setPrototypeOf(subClass,superClass)}(Rect,_Plugin);var _super=Rect_createSuper(Rect);function Rect(){var _this;Rect_classCallCheck(this,Rect);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="rect",_this.iconfont="iconfont icon-square",_this.title={en:"Insert Rectangle",de:"Rechteck einfügen"},_this.params=["strokeWidth","lineType","color"],_this.defaultParamValue={strokeWidth:6,lineType:"solid",color:"#F5222D"},_this.shapeName="rect",_this.lastRect=null,_this.transformer=null,_this.selectedNode=null,_this.isPaint=!1,_this.started=!1,_this.startPoint=[0,0],_this.enableTransform=function(drawEventParams,node){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer;_this.transformer||(_this.transformer=new lib_default.a.Transformer(Object.assign({},transformerStyle,{borderStrokeWidth:0})),drawLayer.add(_this.transformer),_this.transformer.attachTo(node),node.on("mouseenter",(function(){stage.container().style.cursor="move"})),node.on("mouseleave",(function(){stage.container().style.cursor="default"})),stage.container().style.cursor="move"),node&&node.draggable(!0),drawLayer.draw()},_this.disableTransform=function(drawEventParams,node,remove){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,pubSub=drawEventParams.pubSub;_this.transformer&&(_this.transformer.remove(),_this.transformer=null),node&&(node.draggable(!1),node.off("mouseenter"),node.off("mouseleave"),stage.container().style.cursor="default",remove&&(node.hide(),pubSub.pub("PUSH_HISTORY",node),node.remove())),_this.selectedNode=null,drawLayer.draw()},_this.onEnter=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,container=stage.container();container.tabIndex=1,container.focus(),container.addEventListener("keyup",(function(e){"Backspace"===e.key&&_this.selectedNode&&(_this.disableTransform(drawEventParams,_this.selectedNode,!0),drawLayer.draw())}))},_this.onClick=function(drawEventParams){var event=drawEventParams.event;event.target.name&&"rect"===event.target.name()?_this.selectedNode&&_this.selectedNode._id===event.target._id||(_this.selectedNode&&_this.disableTransform(drawEventParams,_this.selectedNode),_this.enableTransform(drawEventParams,event.target),_this.selectedNode=event.target):_this.disableTransform(drawEventParams,_this.selectedNode)},_this.onDrawStart=function(){_this.isPaint=!0},_this.onDraw=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,paramValue=drawEventParams.paramValue,pubSub=drawEventParams.pubSub,pos=stage.getPointerPosition();_this.isPaint&&!_this.transformer&&pos&&(_this.started||(_this.startPoint=[pos.x,pos.y],_this.lastRect=new lib_default.a.Rect({id:uuid(),name:"rect",stroke:paramValue&&paramValue.color?paramValue.color:_this.defaultParamValue.color,strokeWidth:paramValue&&paramValue.strokeWidth?paramValue.strokeWidth:_this.defaultParamValue.strokeWidth,globalCompositeOperation:"source-over",x:pos.x,y:pos.y,dashEnabled:!(!paramValue||!paramValue.lineType||"dash"!==paramValue.lineType),dash:[8],strokeScaleEnabled:!1}),_this.lastRect.on("transformend",(function(){pubSub.pub("PUSH_HISTORY",this)})),_this.lastRect.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)})),drawLayer.add(_this.lastRect),_this.started=!0),_this.lastRect.width(pos.x-_this.startPoint[0]),_this.lastRect.height(pos.y-_this.startPoint[1]),drawLayer.batchDraw())},_this.onDrawEnd=function(drawEventParams){var pubSub=drawEventParams.pubSub;_this.started&&(_this.disableTransform(drawEventParams,_this.selectedNode),_this.lastRect&&pubSub.pub("PUSH_HISTORY",_this.lastRect)),_this.isPaint=!1,_this.started=!1},_this.onLeave=function(drawEventParams){_this.isPaint=!1,_this.started=!1,_this.disableTransform(drawEventParams,_this.selectedNode)},_this.onNodeRecreate=function(drawEventParams,node){var pubSub=drawEventParams.pubSub;node.on("transformend",(function(){pubSub.pub("PUSH_HISTORY",this)})),node.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)}))},_this}return function Rect_createClass(Constructor,protoProps,staticProps){return protoProps&&Rect_defineProperties(Constructor.prototype,protoProps),staticProps&&Rect_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Rect)}(Plugin);function Repeal_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Repeal_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Repeal_setPrototypeOf(o,p){return Repeal_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Repeal_setPrototypeOf(o,p)}function Repeal_createSuper(Derived){var hasNativeReflectConstruct=function Repeal_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Repeal_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Repeal_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Repeal_possibleConstructorReturn(this,result)}}function Repeal_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Repeal_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Repeal_getPrototypeOf(o){return Repeal_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Repeal_getPrototypeOf(o)}var Repeal_Repeal=function(_Plugin){!function Repeal_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Repeal_setPrototypeOf(subClass,superClass)}(Repeal,_Plugin);var _super=Repeal_createSuper(Repeal);function Repeal(){var _this;Repeal_classCallCheck(this,Repeal);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="repeal",_this.iconfont="iconfont icon-repeal",_this.title={en:"Revoke",de:"Rückgängig machen"},_this.onEnter=function(drawEventParams){var drawLayer=drawEventParams.drawLayer,historyStack=drawEventParams.historyStack,plugins=drawEventParams.plugins,pubSub=drawEventParams.pubSub;drawLayer.removeChildren(),historyStack.pop(),pubSub.pub("POP_HISTORY",historyStack),historyStack.forEach((function(node,index){for(var flag=!1,i=index+1;i<historyStack.length;i++)if(historyStack[i].attrs.id===node.attrs.id){flag=!0;break}if(!flag){var recreatedNode=lib_default.a.Node.create(node);drawLayer.add(recreatedNode),setTimeout((function(){for(var _i=0;_i<plugins.length;_i++)if(plugins[_i].shapeName&&plugins[_i].shapeName===recreatedNode.name()){plugins[_i].onNodeRecreate&&plugins[_i].onNodeRecreate(drawEventParams,recreatedNode);break}}))}})),drawLayer.draw()},_this}return function Repeal_createClass(Constructor,protoProps,staticProps){return protoProps&&Repeal_defineProperties(Constructor.prototype,protoProps),staticProps&&Repeal_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Repeal)}(Plugin);__webpack_require__("./node_modules/core-js/modules/es.array.fill.js");function Text_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Text_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Text_setPrototypeOf(o,p){return Text_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Text_setPrototypeOf(o,p)}function Text_createSuper(Derived){var hasNativeReflectConstruct=function Text_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Text_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Text_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Text_possibleConstructorReturn(this,result)}}function Text_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Text_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Text_getPrototypeOf(o){return Text_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Text_getPrototypeOf(o)}var Text_Text=function(_Plugin){!function Text_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Text_setPrototypeOf(subClass,superClass)}(Text,_Plugin);var _super=Text_createSuper(Text);function Text(){var _this;Text_classCallCheck(this,Text);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="text",_this.iconfont="iconfont icon-text",_this.title={en:"Insert text",de:"Text einfügen"},_this.params=["fontSize","color"],_this.defaultParamValue={fontSize:24,color:"#F5222D"},_this.shapeName="text",_this.transformer=null,_this.selectedNode=null,_this.removeTextareaBlurModal=function(){var textareaBlurModal=document.getElementById("textareaBlurModal");textareaBlurModal&&(textareaBlurModal.removeEventListener("click",_this.removeTextareaBlurModal),document.body.removeChild(textareaBlurModal))},_this.addTextareaBlurModal=function(stage){if(!document.getElementById("textareaBlurModal")){var container=stage.container().getBoundingClientRect(),textareaBlurModal=document.createElement("div");textareaBlurModal.id="textareaBlurModal",textareaBlurModal.style.position="fixed",textareaBlurModal.style.left=container.left+"px",textareaBlurModal.style.top=container.top+"px",textareaBlurModal.style.width=container.width+"px",textareaBlurModal.style.height=container.height+"px",textareaBlurModal.style.zIndex="999",document.body.appendChild(textareaBlurModal),textareaBlurModal.addEventListener("click",_this.removeTextareaBlurModal)}},_this.createTextarea=function(stage,drawLayer,transformer,textNode,pubSub){var textarea=document.createElement("textarea");return textarea.value=textNode.text(),textarea.style.position="absolute",textarea.style.left=textNode.x()+"px",textarea.style.top=textNode.y()+"px",textarea.style.width=textNode.width()+"px",textarea.style.height=textNode.height()+"px",textarea.style.lineHeight=String(textNode.lineHeight()),textarea.style.padding=textNode.padding()+"px",textarea.style.margin="0px",textarea.style.fontSize=textNode.fontSize()+"px",textarea.style.fontWeight="bold",textarea.style.color=textNode.fill(),textarea.style.fontFamily=textNode.fontFamily(),textarea.style.border="none",textarea.style.outline="none",textarea.style.overflow="hidden",textarea.style.background="none",textarea.style.resize="none",textarea.style.zIndex="1000",textarea.style.boxSizing="content-box",textarea.addEventListener("keyup",(function(e){textNode.text(e.target.value),drawLayer.draw(),textarea.style.width=textNode.width()+"px",textarea.style.height=textNode.height()+"px"})),textarea.addEventListener("blur",(function(){""!==textarea.value?(textNode.text(textarea.value),transformer.hide(),textNode.show()):(textNode.destroy(),transformer.destroy()),textarea.parentNode.removeChild(textarea),drawLayer.draw(),_this.removeTextareaBlurModal(),pubSub.pub("PUSH_HISTORY",textNode)})),textarea},_this.enableTransform=function(drawEventParams,node){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer;_this.transformer||(_this.transformer=new lib_default.a.Transformer(Object.assign({},transformerStyle,{enabledAnchors:[],padding:2})),drawLayer.add(_this.transformer),_this.transformer.attachTo(node),node.on("mouseenter",(function(){stage.container().style.cursor="move"})),node.on("mouseleave",(function(){stage.container().style.cursor="text"})),stage.container().style.cursor="move"),node&&node.draggable(!0),drawLayer.draw()},_this.disableTransform=function(drawEventParams,node,remove){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,pubSub=drawEventParams.pubSub;_this.transformer&&(_this.transformer.remove(),_this.transformer=null),node&&(node.draggable(!1),node.off("mouseenter"),node.off("mouseleave"),stage.container().style.cursor="text",remove&&(node.hide(),pubSub.pub("PUSH_HISTORY",node),node.remove(),node.remove())),_this.selectedNode=null,drawLayer.draw()},_this.onEnter=function(drawEventParams){var stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,container=stage.container();container.style.cursor="text",container.tabIndex=1,container.focus(),container.addEventListener("keyup",(function(e){"Backspace"===e.key&&_this.selectedNode&&(_this.disableTransform(drawEventParams,_this.selectedNode,!0),drawLayer.draw())}))},_this.onClick=function(drawEventParams){var event=drawEventParams.event,stage=drawEventParams.stage,drawLayer=drawEventParams.drawLayer,paramValue=drawEventParams.paramValue,pubSub=drawEventParams.pubSub;if(event.target.name&&"text"===event.target.name())_this.selectedNode&&_this.selectedNode._id===event.target._id||(_this.selectedNode&&_this.disableTransform(drawEventParams,_this.selectedNode),_this.enableTransform(drawEventParams,event.target),_this.selectedNode=event.target);else if(_this.selectedNode)_this.disableTransform(drawEventParams,_this.selectedNode);else{var fontSize=paramValue&&paramValue.fontSize?paramValue.fontSize:_this.defaultParamValue.fontSize,color=paramValue&&paramValue.color?paramValue.color:_this.defaultParamValue.color,startPos=stage.getPointerPosition();if(startPos){var textNode=new lib_default.a.Text({id:uuid(),name:"text",x:startPos.x,y:startPos.y-10,fontSize:fontSize,fontStyle:"bold",fill:color,padding:3,lineHeight:1.1});textNode.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)}));var textareaTransformer=new lib_default.a.Transformer({node:textNode,enabledAnchors:[],rotateEnabled:!1,borderStroke:color});drawLayer.add(textNode),drawLayer.add(textareaTransformer),textNode.hide(),drawLayer.draw();var textarea=_this.createTextarea(stage,drawLayer,textareaTransformer,textNode,pubSub);stage.container().appendChild(textarea),textarea.focus(),_this.addTextareaBlurModal(stage),textNode.on("dblclick dbltap",(function(e){_this.disableTransform(drawEventParams,_this.selectedNode),e.cancelBubble=!0;var textarea=_this.createTextarea(stage,drawLayer,textareaTransformer,textNode,pubSub);stage.container().appendChild(textarea),textarea.focus(),textNode.hide(),textareaTransformer.show(),drawLayer.draw(),_this.addTextareaBlurModal(stage)}))}}},_this.onLeave=function(drawEventParams){drawEventParams.stage.container().style.cursor="default",_this.removeTextareaBlurModal(),_this.disableTransform(drawEventParams,_this.selectedNode)},_this.onNodeRecreate=function(drawEventParams,node){var pubSub=drawEventParams.pubSub;node.on("dragend",(function(){pubSub.pub("PUSH_HISTORY",this)}))},_this}return function Text_createClass(Constructor,protoProps,staticProps){return protoProps&&Text_defineProperties(Constructor.prototype,protoProps),staticProps&&Text_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Text)}(Plugin);function PluginFactory_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function PluginFactory_createClass(Constructor,protoProps,staticProps){return protoProps&&PluginFactory_defineProperties(Constructor.prototype,protoProps),staticProps&&PluginFactory_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}var PluginFactory_PluginFactory=PluginFactory_createClass((function PluginFactory(){!function PluginFactory_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PluginFactory),this.plugins=[new Arrow_Arrow,new Circle_Circle,new Crop_Crop,new Download,new Eraser_Eraser,new Mosaic_Mosaic,new Pen_Pen,new Rect_Rect,new Repeal_Repeal,new Text_Text]})),pubsub=(__webpack_require__("./node_modules/core-js/modules/es.string.sub.js"),__webpack_require__("./node_modules/pubsub-js/src/pubsub.js")),pubsub_default=__webpack_require__.n(pubsub);function PubSub_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function PubSub_createClass(Constructor,protoProps,staticProps){return protoProps&&PubSub_defineProperties(Constructor.prototype,protoProps),staticProps&&PubSub_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}var PubSub_PubSub=PubSub_createClass((function PubSub(id){var _this=this;!function PubSub_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PubSub),this.id=void 0,this.pub=function(name,param){pubsub_default.a.publish(_this.id+"_"+name,param)},this.sub=function(name,callback){pubsub_default.a.subscribe(_this.id+"_"+name,callback)},this.id=id})),jsx_runtime=(__webpack_require__("./node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("./node_modules/react/jsx-runtime.js")),_excluded=["forwardRef"];function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var EditorContext=react_default.a.createContext({}),withEditorContext=function(Context){var shouldRender=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};return function(WrappedComponent){var InjectContext=function InjectContext(props){var forwardRef=props.forwardRef,rest=_objectWithoutProperties(props,_excluded);return Object(jsx_runtime.jsx)(Context.Consumer,{children:function children(context){return shouldRender(context)?Object(jsx_runtime.jsx)(WrappedComponent,Object.assign({ref:forwardRef},rest,context)):null}})};return react_default.a.forwardRef((function(props,ref){return Object(jsx_runtime.jsx)(InjectContext,Object.assign({forwardRef:ref},props))}))}}(EditorContext);try{withEditorContext.displayName="withEditorContext",withEditorContext.__docgenInfo={description:"",displayName:"withEditorContext",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/EditorContext.tsx#withEditorContext"]={docgenInfo:withEditorContext.__docgenInfo,name:"withEditorContext",path:"src/components/EditorContext.tsx#withEditorContext"})}catch(__react_docgen_typescript_loader_error){}function Palette_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Palette_setPrototypeOf(o,p){return Palette_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Palette_setPrototypeOf(o,p)}function Palette_createSuper(Derived){var hasNativeReflectConstruct=function Palette_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Palette_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Palette_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Palette_possibleConstructorReturn(this,result)}}function Palette_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Palette_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Palette_getPrototypeOf(o){return Palette_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Palette_getPrototypeOf(o)}var Palette_Palette=function(_React$Component){!function Palette_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Palette_setPrototypeOf(subClass,superClass)}(Palette,_React$Component);var _super=Palette_createSuper(Palette);function Palette(_props){var _this;!function Palette_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Palette),(_this=_super.call(this,_props)).containerId=prefixCls+uuid(),_this.canvasWidth=void 0,_this.canvasHeight=void 0,_this.pixelRatio=void 0,_this.stage=null,_this.imageLayer=null,_this.drawLayer=null,_this.imageData=null,_this.historyStack=[],_this.pubSub=void 0,_this.init=function(){var _this$props=_this.props,getStage=_this$props.getStage,imageObj=_this$props.imageObj;_this.stage=new lib_default.a.Stage({container:_this.containerId,width:_this.canvasWidth,height:_this.canvasHeight}),getStage&&getStage(_this.resetStage(_this.stage));var img=new lib_default.a.Image({x:0,y:0,image:imageObj,width:_this.canvasWidth,height:_this.canvasHeight});_this.imageLayer=new lib_default.a.Layer,_this.stage.add(_this.imageLayer),_this.imageLayer.setZIndex(0),_this.imageLayer.add(img),_this.imageLayer.draw(),_this.imageData=_this.generateImageData(imageObj,_this.canvasWidth,_this.canvasHeight),_this.drawLayer=new lib_default.a.Layer,_this.stage.add(_this.drawLayer),_this.bindEvents()},_this.reload=function(imgObj,width,height){var getStage=_this.props.getStage;_this.removeEvents(),_this.historyStack=[],_this.stage=new lib_default.a.Stage({container:_this.containerId,width:width,height:height}),getStage&&getStage(_this.resetStage(_this.stage));var img=new lib_default.a.Image({x:0,y:0,image:imgObj,width:width,height:height});_this.imageLayer=new lib_default.a.Layer,_this.stage.add(_this.imageLayer),_this.imageLayer.add(img),_this.imageLayer.draw(),_this.imageData=_this.generateImageData(imgObj,width,height),_this.drawLayer=new lib_default.a.Layer,_this.stage.add(_this.drawLayer),_this.bindEvents()},_this.resetStage=function(stage){return stage._pixelRatio=_this.pixelRatio,stage.clearAndToCanvas=function(config){var currentPlugin=_this.props.currentPlugin;return currentPlugin&&currentPlugin.onLeave&&currentPlugin.onLeave(_this.getDrawEventParams(null)),stage.toCanvas(config)},stage},_this.bindEvents=function(){if(_this.stage&&_this.drawLayer){var _this$props2=_this.props,plugins=_this$props2.plugins,currentPlugin=_this$props2.currentPlugin,handlePluginChange=_this$props2.handlePluginChange;_this.removeEvents(),_this.stage.add(_this.drawLayer),_this.drawLayer.setZIndex(1),_this.stage.on("click tap",(function(e){if(e.target.name&&e.target.name())for(var name=e.target.name(),_loop=function _loop(i){if(plugins[i].shapeName&&plugins[i].shapeName===name&&(!currentPlugin||!currentPlugin.shapeName||name!==currentPlugin.shapeName))return event=e,setTimeout((function(){plugins[i].onClick&&plugins[i].onClick(_this.getDrawEventParams(event))})),handlePluginChange(plugins[i]),{v:void 0};var event},i=0;i<plugins.length;i++){var _ret=_loop(i);if("object"==typeof _ret)return _ret.v}currentPlugin&&currentPlugin.onClick&&currentPlugin.onClick(_this.getDrawEventParams(e))})),_this.stage.on("mousedown touchstart",(function(e){currentPlugin&&currentPlugin.onDrawStart&&currentPlugin.onDrawStart(_this.getDrawEventParams(e))})),_this.stage.on("mousemove touchmove",(function(e){currentPlugin&&currentPlugin.onDraw&&currentPlugin.onDraw(_this.getDrawEventParams(e))})),_this.stage.on("mouseup touchend",(function(e){currentPlugin&&currentPlugin.onDrawEnd&&currentPlugin.onDrawEnd(_this.getDrawEventParams(e))}))}},_this.removeEvents=function(){_this.stage&&(_this.stage.off("click tap"),_this.stage.off("mousedown touchstart"),_this.stage.off("mousemove touchmove"),_this.stage.off("mouseup touchend"))},_this.subHistoryStack=function(){_this.pubSub.sub("PUSH_HISTORY",(function(_,node){var _this$props3=_this.props,toolbarItemConfig=_this$props3.toolbarItemConfig,updateToolbarItemConfig=_this$props3.updateToolbarItemConfig;if(0===_this.historyStack.length){var newToolbarItemConfig=Object.assign({},toolbarItemConfig);newToolbarItemConfig.repeal&&(newToolbarItemConfig.repeal.disable=!1,updateToolbarItemConfig(newToolbarItemConfig))}_this.historyStack.push(node.toObject())})),_this.pubSub.sub("POP_HISTORY",(function(_,historyStack){var _this$props4=_this.props,toolbarItemConfig=_this$props4.toolbarItemConfig,updateToolbarItemConfig=_this$props4.updateToolbarItemConfig;if(0===historyStack.length){var newToolbarItemConfig=Object.assign({},toolbarItemConfig);newToolbarItemConfig.repeal&&(newToolbarItemConfig.repeal.disable=!0,updateToolbarItemConfig(newToolbarItemConfig))}}))},_this.generateImageData=function(imgObj,width,height){var canvas=document.createElement("canvas");canvas.width=width,canvas.height=height;var ctx=canvas.getContext("2d");return ctx.drawImage(imgObj,0,0,width,height),ctx.getImageData(0,0,width,height)},_this.getDrawEventParams=function(e){var props=_this.props;return{event:e,stage:_this.stage,imageLayer:_this.imageLayer,drawLayer:_this.drawLayer,imageData:_this.imageData,reload:_this.reload,historyStack:_this.historyStack,pixelRatio:_this.pixelRatio,pubSub:_this.pubSub,containerWidth:props.containerWidth,containerHeight:props.containerHeight,plugins:props.plugins,toolbar:props.toolbar,currentPlugin:props.currentPlugin,handlePluginChange:props.handlePluginChange,paramValue:props.paramValue,handlePluginParamValueChange:props.handlePluginParamValueChange,toolbarItemConfig:props.toolbarItemConfig,updateToolbarItemConfig:props.updateToolbarItemConfig,language:props.language}};var containerWidth=_props.containerWidth,_imageObj=_props.imageObj,imageNatureWidth=_imageObj.naturalWidth,imageNatureHeight=_imageObj.naturalHeight,wRatio=containerWidth/imageNatureWidth,hRatio=_props.height/imageNatureHeight,scaleRatio=Math.min(wRatio,hRatio,1);return _this.canvasWidth=Math.round(imageNatureWidth*scaleRatio),_this.canvasHeight=Math.round(imageNatureHeight*scaleRatio),_this.pixelRatio=1/scaleRatio,lib_default.a.pixelRatio=_this.pixelRatio,_this.pubSub=new PubSub_PubSub(_this.containerId),_this.subHistoryStack(),_this}return function Palette_createClass(Constructor,protoProps,staticProps){return protoProps&&Palette_defineProperties(Constructor.prototype,protoProps),staticProps&&Palette_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Palette,[{key:"componentDidMount",value:function componentDidMount(){this.init();var currentPlugin=this.props.currentPlugin;currentPlugin&&currentPlugin.onEnter&&currentPlugin.onEnter(this.getDrawEventParams(null))}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var prevCurrentPlugin=prevProps.currentPlugin,currentPlugin=this.props.currentPlugin;currentPlugin!==prevCurrentPlugin&&(currentPlugin&&(this.bindEvents(),currentPlugin.onEnter&&currentPlugin.onEnter(this.getDrawEventParams(null))),prevCurrentPlugin&&prevCurrentPlugin.onLeave&&prevCurrentPlugin.onLeave(this.getDrawEventParams(null)))}},{key:"componentWillUnmount",value:function componentWillUnmount(){var currentPlugin=this.props.currentPlugin;currentPlugin&&currentPlugin.onLeave&&currentPlugin.onLeave(this.getDrawEventParams(null))}},{key:"render",value:function render(){var height=this.props.height,style={width:this.context.containerWidth,height:height};return Object(jsx_runtime.jsx)("div",{className:prefixCls+"-palette",style:style,children:Object(jsx_runtime.jsx)("div",{id:this.containerId,className:prefixCls+"-container"})})}}]),Palette}(react_default.a.Component),components_Palette=withEditorContext(Palette_Palette);try{Palette_Palette.displayName="Palette",Palette_Palette.__docgenInfo={description:"",displayName:"Palette",props:{height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},imageObj:{defaultValue:null,description:"",name:"imageObj",required:!0,type:{name:"HTMLImageElement"}},getStage:{defaultValue:null,description:"",name:"getStage",required:!1,type:{name:"(stage: any) => void"}},containerWidth:{defaultValue:null,description:"",name:"containerWidth",required:!0,type:{name:"number"}},containerHeight:{defaultValue:null,description:"",name:"containerHeight",required:!0,type:{name:"number"}},plugins:{defaultValue:null,description:"",name:"plugins",required:!0,type:{name:"Plugin[]"}},toolbar:{defaultValue:null,description:"",name:"toolbar",required:!0,type:{name:"{ items: string[]; }"}},currentPlugin:{defaultValue:null,description:"",name:"currentPlugin",required:!0,type:{name:"Plugin"}},handlePluginChange:{defaultValue:null,description:"",name:"handlePluginChange",required:!0,type:{name:"(plugin: Plugin) => void"}},paramValue:{defaultValue:null,description:"",name:"paramValue",required:!0,type:{name:"PluginParamValue"}},handlePluginParamValueChange:{defaultValue:null,description:"",name:"handlePluginParamValueChange",required:!0,type:{name:"(paramValue: PluginParamValue) => void"}},toolbarItemConfig:{defaultValue:null,description:"",name:"toolbarItemConfig",required:!0,type:{name:"any"}},updateToolbarItemConfig:{defaultValue:null,description:"",name:"updateToolbarItemConfig",required:!0,type:{name:"(config: any) => void"}},language:{defaultValue:null,description:"",name:"language",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Palette.tsx#Palette"]={docgenInfo:Palette_Palette.__docgenInfo,name:"Palette",path:"src/components/Palette.tsx#Palette"})}catch(__react_docgen_typescript_loader_error){}var colors=["#F5222D","#FFEB00","#00B4FF","#52C51A ","#19191A","#FFFFFF"];function ColorSetting(props){return Object(jsx_runtime.jsx)("span",{style:{margin:"0 8px",fontSize:0},children:colors.map((function(color){return Object(jsx_runtime.jsx)("span",{className:prefixCls+"-color-square "+(props.value===color?prefixCls+"-color-square-activated":""),style:{backgroundColor:color},onClick:function onClick(){return props.onChange(color)}},color)}))})}ColorSetting.displayName="ColorSetting";try{ColorSetting.displayName="ColorSetting",ColorSetting.__docgenInfo={description:"",displayName:"ColorSetting",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(color: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ParamSetting/ColorSetting.tsx#ColorSetting"]={docgenInfo:ColorSetting.__docgenInfo,name:"ColorSetting",path:"src/components/ParamSetting/ColorSetting.tsx#ColorSetting"})}catch(__react_docgen_typescript_loader_error){}function FontSizeSetting(props){return Object(jsx_runtime.jsxs)("span",{style:{margin:"0 8px"},children:[Object(jsx_runtime.jsx)("button",{className:prefixCls+"-font-size "+(16===props.value?prefixCls+"-font-size-activated":""),onClick:function onClick(){return props.onChange(16)},children:"S"}),Object(jsx_runtime.jsx)("button",{className:prefixCls+"-font-size "+(24===props.value?prefixCls+"-font-size-activated":""),onClick:function onClick(){return props.onChange(24)},children:"M"}),Object(jsx_runtime.jsx)("button",{className:prefixCls+"-font-size "+(32===props.value?prefixCls+"-font-size-activated":""),onClick:function onClick(){return props.onChange(32)},children:"L"})]})}FontSizeSetting.displayName="FontSizeSetting";try{FontSizeSetting.displayName="FontSizeSetting",FontSizeSetting.__docgenInfo={description:"",displayName:"FontSizeSetting",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(fontSize: number) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ParamSetting/FontSizeSetting.tsx#FontSizeSetting"]={docgenInfo:FontSizeSetting.__docgenInfo,name:"FontSizeSetting",path:"src/components/ParamSetting/FontSizeSetting.tsx#FontSizeSetting"})}catch(__react_docgen_typescript_loader_error){}function LineTypeSetting(props){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("i",{className:"iconfont icon-line2 "+prefixCls+"-line-type\n          "+("solid"===props.value?prefixCls+"-line-type-activated":""),onClick:function onClick(){return props.onChange("solid")}}),Object(jsx_runtime.jsx)("i",{className:"iconfont icon-dotted-line "+prefixCls+"-line-type\n          "+("dash"===props.value?prefixCls+"-line-type-activated":""),onClick:function onClick(){return props.onChange("dash")}})]})}try{LineTypeSetting.displayName="LineTypeSetting",LineTypeSetting.__docgenInfo={description:"",displayName:"LineTypeSetting",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:'(lineType: "solid" | "dash") => void'}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ParamSetting/LineTypeSetting.tsx#LineTypeSetting"]={docgenInfo:LineTypeSetting.__docgenInfo,name:"LineTypeSetting",path:"src/components/ParamSetting/LineTypeSetting.tsx#LineTypeSetting"})}catch(__react_docgen_typescript_loader_error){}function StrokeWidthSetting(props){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("span",{className:prefixCls+"-stroke-circle "+prefixCls+"-stroke-circle-small\n          "+(2===props.value?prefixCls+"-stroke-circle-activated":""),onClick:function onClick(){return props.onChange(2)}}),Object(jsx_runtime.jsx)("span",{className:prefixCls+"-stroke-circle "+prefixCls+"-stroke-circle-medium\n          "+(6===props.value?prefixCls+"-stroke-circle-activated":""),onClick:function onClick(){return props.onChange(6)}}),Object(jsx_runtime.jsx)("span",{className:prefixCls+"-stroke-circle "+prefixCls+"-stroke-circle-large\n          "+(8===props.value?prefixCls+"-stroke-circle-activated":""),onClick:function onClick(){return props.onChange(8)}})]})}try{StrokeWidthSetting.displayName="StrokeWidthSetting",StrokeWidthSetting.__docgenInfo={description:"",displayName:"StrokeWidthSetting",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(strokeWidth: number) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ParamSetting/StrokeWidthSetting.tsx#StrokeWidthSetting"]={docgenInfo:StrokeWidthSetting.__docgenInfo,name:"StrokeWidthSetting",path:"src/components/ParamSetting/StrokeWidthSetting.tsx#StrokeWidthSetting"})}catch(__react_docgen_typescript_loader_error){}function ParamSetting(props){function handleStrokeWidthChange(strokeWidth){props.onChange(Object.assign({},props.paramValue,{strokeWidth:strokeWidth}))}function handleLineTypeChange(lineType){props.onChange(Object.assign({},props.paramValue,{lineType:lineType}))}function handleColorChange(color){props.onChange(Object.assign({},props.paramValue,{color:color}))}function handleFontSizeChange(fontSize){props.onChange(Object.assign({},props.paramValue,{fontSize:fontSize}))}return Object(jsx_runtime.jsx)("div",{className:prefixCls+"-param-setting",children:props.paramNames.map((function(paramName){return function renderParamComponent(paramName){switch(paramName){case"strokeWidth":return Object(jsx_runtime.jsx)(StrokeWidthSetting,{value:props.paramValue?props.paramValue.strokeWidth:void 0,onChange:handleStrokeWidthChange},"stroke-width-setting");case"lineType":return Object(jsx_runtime.jsx)(LineTypeSetting,{value:props.paramValue?props.paramValue.lineType:void 0,onChange:handleLineTypeChange},"line-type-setting");case"color":return Object(jsx_runtime.jsx)(ColorSetting,{value:props.paramValue?props.paramValue.color:void 0,onChange:handleColorChange},"color-setting");case"fontSize":return Object(jsx_runtime.jsx)(FontSizeSetting,{value:props.paramValue?props.paramValue.fontSize:void 0,onChange:handleFontSizeChange},"font-size-setting");default:return null}}(paramName)}))})}ParamSetting.displayName="ParamSetting";try{ParamSetting.displayName="ParamSetting",ParamSetting.__docgenInfo={description:"",displayName:"ParamSetting",props:{paramNames:{defaultValue:null,description:"",name:"paramNames",required:!0,type:{name:"PluginParamName[]"}},paramValue:{defaultValue:null,description:"",name:"paramValue",required:!0,type:{name:"PluginParamValue"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: PluginParamValue) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ParamSetting/index.tsx#ParamSetting"]={docgenInfo:ParamSetting.__docgenInfo,name:"ParamSetting",path:"src/components/ParamSetting/index.tsx#ParamSetting"})}catch(__react_docgen_typescript_loader_error){}var es=__webpack_require__("./node_modules/rc-tooltip/es/index.js");__webpack_require__("./node_modules/rc-tooltip/assets/bootstrap_white.css");function Toolbar(){var _useContext=Object(react.useContext)(EditorContext),containerWidth=_useContext.containerWidth,plugins=_useContext.plugins,toolbar=_useContext.toolbar,currentPlugin=_useContext.currentPlugin,paramValue=_useContext.paramValue,handlePluginChange=_useContext.handlePluginChange,handlePluginParamValueChange=_useContext.handlePluginParamValueChange,toolbarItemConfig=_useContext.toolbarItemConfig,language=_useContext.language,style={width:containerWidth};function renderPlugin(plugin){var isActivated=!(!currentPlugin||currentPlugin.name!==plugin.name),paramNames=currentPlugin?currentPlugin.params:[],isDisabled=toolbarItemConfig[plugin.name].disable,title=plugin.title[language]||plugin.title.en;return paramNames&&0!==paramNames.length?Object(jsx_runtime.jsx)(es.a,{placement:"bottom",overlay:Object(jsx_runtime.jsx)(ParamSetting,{paramNames:paramNames,paramValue:paramValue,onChange:handlePluginParamValueChange}),visible:isActivated,overlayClassName:prefixCls+"-tooltip",arrowContent:Object(jsx_runtime.jsx)("div",{className:"rc-tooltip-arrow-inner"}),children:Object(jsx_runtime.jsx)("span",{className:prefixCls+"-toolbar-icon "+(isActivated?"activated":"")+" "+(isDisabled?"disabled":""),children:Object(jsx_runtime.jsx)("i",{title:title,className:plugin.iconfont,onClick:function onClick(){return handlePluginChange(plugin)}})},plugin.name)},plugin.name):Object(jsx_runtime.jsx)("span",{className:prefixCls+"-toolbar-icon "+(isActivated?"activated":"")+" "+(isDisabled?"disabled":""),children:Object(jsx_runtime.jsx)("i",{title:title,className:plugin.iconfont,onClick:function onClick(){return handlePluginChange(plugin)}})},plugin.name)}return Object(jsx_runtime.jsx)("div",{className:prefixCls+"-toolbar",style:style,children:toolbar.items.map((function(item){if("|"===item)return Object(jsx_runtime.jsx)("span",{className:prefixCls+"-toolbar-separator"},item);for(var i=0;i<plugins.length;i++)if(plugins[i].name===item)return renderPlugin(plugins[i]);return null}))})}Toolbar.displayName="Toolbar";__webpack_require__("./src/styles/index.less");function src_toConsumableArray(arr){return function src_arrayWithoutHoles(arr){if(Array.isArray(arr))return src_arrayLikeToArray(arr)}(arr)||function src_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||src_unsupportedIterableToArray(arr)||function src_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||src_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function src_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return src_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?src_arrayLikeToArray(o,minLen):void 0}}function src_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ReactImageEditor(props){for(var _useState2=_slicedToArray(Object(react.useState)(null),2),imageObj=_useState2[0],setImageObj=_useState2[1],language=(props.language||"en").substring(0,2),pluginFactory=new PluginFactory_PluginFactory,plugins=[].concat(src_toConsumableArray(pluginFactory.plugins),src_toConsumableArray(props.plugins)),defaultPlugin=null,defaultParamValue={},i=0;i<plugins.length;i++)plugins[i].language=language,props.defaultPluginName&&props.toolbar&&plugins[i].name===props.defaultPluginName&&(defaultPlugin=plugins[i]).defaultParamValue&&(defaultParamValue=defaultPlugin.defaultParamValue);var _useState4=_slicedToArray(Object(react.useState)(defaultPlugin),2),currentPlugin=_useState4[0],setCurrentPlugin=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(defaultParamValue),2),paramValue=_useState6[0],setParamValue=_useState6[1],config={};plugins.map((function(plugin){"repeal"===plugin.name?config[plugin.name]={disable:!0}:config[plugin.name]={disable:!1}}));var _useState8=_slicedToArray(Object(react.useState)(config),2),toolbarItemConfig=_useState8[0],setToolbarItemConfig=_useState8[1];Object(react.useEffect)((function(){var image=new Image;image.onload=function(){setImageObj(image)},void 0!==props.crossOrigin&&(image.crossOrigin=props.crossOrigin),image.src=props.src}),[props.src,props.crossOrigin]);var style=Object.assign({width:props.width+"px",height:props.height+"px"},props.style);return Object(jsx_runtime.jsx)(EditorContext.Provider,{value:{containerWidth:props.width,containerHeight:props.height,plugins:plugins,toolbar:props.toolbar,currentPlugin:currentPlugin,paramValue:paramValue,handlePluginChange:function handlePluginChange(plugin){setCurrentPlugin(plugin),plugin.defaultParamValue&&setParamValue(plugin.defaultParamValue),plugin.params||setTimeout((function(){setCurrentPlugin(null)}))},handlePluginParamValueChange:function handlePluginParamValueChange(value){setParamValue(value)},toolbarItemConfig:toolbarItemConfig,updateToolbarItemConfig:function updateToolbarItemConfig(config){setToolbarItemConfig(config)},language:language},children:Object(jsx_runtime.jsx)("div",{className:"react-img-editor",style:style,children:imageObj?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(components_Palette,{height:props.height-42,imageObj:imageObj,getStage:props.getStage}),Object(jsx_runtime.jsx)(Toolbar,{})]}):null})})}ReactImageEditor.displayName="ReactImageEditor",ReactImageEditor.defaultProps={width:700,height:500,style:{},plugins:[],toolbar:{items:["pen","eraser","arrow","rect","circle","mosaic","text","|","repeal","download","crop"]}};try{src.displayName="src",src.__docgenInfo={description:"",displayName:"src",props:{width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"number"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},plugins:{defaultValue:null,description:"",name:"plugins",required:!1,type:{name:"Plugin[]"}},toolbar:{defaultValue:null,description:"",name:"toolbar",required:!1,type:{name:"{ items: string[]; }"}},src:{defaultValue:null,description:"",name:"src",required:!0,type:{name:"string"}},getStage:{defaultValue:null,description:"",name:"getStage",required:!1,type:{name:"(stage: any) => void"}},defaultPluginName:{defaultValue:null,description:"",name:"defaultPluginName",required:!1,type:{name:"string"}},crossOrigin:{defaultValue:null,description:"",name:"crossOrigin",required:!1,type:{name:"string"}},language:{defaultValue:null,description:"",name:"language",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/index.tsx#src"]={docgenInfo:src.__docgenInfo,name:"src",path:"src/index.tsx#src"})}catch(__react_docgen_typescript_loader_error){}__webpack_exports__.default={title:"ReactImgEditor"};var index_stories_image1="https://cstore-public.seewo.com/faq-service/4e3f2924f1d4432f82e760468bf680f0",index_stories_Simple=function Simple(){return Object(jsx_runtime.jsx)(ReactImageEditor,{src:index_stories_image1,width:736,height:414,plugins:[],defaultPluginName:"text",crossOrigin:"anonymous"})};index_stories_Simple.displayName="Simple";var index_stories_GermanTexts=function GermanTexts(){return Object(jsx_runtime.jsx)(ReactImageEditor,{src:index_stories_image1,width:736,height:414,plugins:[],defaultPluginName:"text",crossOrigin:"anonymous",language:"de"})};index_stories_GermanTexts.displayName="GermanTexts";var index_stories_MulitpleInstances=function MulitpleInstances(){return Object(jsx_runtime.jsxs)("div",{style:{display:"flex"},children:[Object(jsx_runtime.jsx)(ReactImageEditor,{src:"https://cstore-public.seewo.com/faq-service/4e3f2924f1d4432f82e760468bf680f0",width:500,height:414,plugins:[],defaultPluginName:"text",crossOrigin:"anonymous"}),Object(jsx_runtime.jsx)("div",{style:{width:"10px"}}),Object(jsx_runtime.jsx)(ReactImageEditor,{src:"https://cvte-dev-public.seewo.com/faq-service-test/4db524ec93324794b983bf7cd78b2ae1",width:500,height:414,plugins:[],defaultPluginName:"rect",crossOrigin:"anonymous"})]})};index_stories_MulitpleInstances.displayName="MulitpleInstances"},"./src/styles/index.less":function(module,exports,__webpack_require__){var api=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),content=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/less-loader/dist/cjs.js!./src/styles/index.less");"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},"./storybook-init-framework-entry.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js")},0:function(module,exports,__webpack_require__){__webpack_require__("./node_modules/@storybook/core-client/dist/esm/globals/polyfills.js"),__webpack_require__("./node_modules/@storybook/core-client/dist/esm/globals/globals.js"),__webpack_require__("./storybook-init-framework-entry.js"),__webpack_require__("./node_modules/@storybook/react/dist/esm/client/preview/config-generated-config-entry.js"),module.exports=__webpack_require__("./generated-stories-entry.js")},1:function(module,exports){}},[[0,2,3]]]);